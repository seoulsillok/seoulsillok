---
import Layout from '../../layouts/Layout.astro';
import { dongRecords } from '../../data/dongs';

const districts = dongRecords.reduce((acc, dong) => {
  const existing = acc.get(dong.district) ?? [];
  existing.push(dong);
  acc.set(dong.district, existing);
  return acc;
}, new Map<string, typeof dongRecords>());

const orderedDistricts = Array.from(districts.entries())
  .sort((a, b) => a[0].localeCompare(b[0], 'ko'))
  .map(([name, dongs]) => ({
    name,
    dongs: dongs.sort((a, b) => a.nameKo.localeCompare(b.nameKo, 'ko'))
  }));
---

<Layout title="동네 기록 - Seoul Sillok">
    <div class="dong-container">
        <h1>서울 동네 기록</h1>
        <p class="subtitle kr">서울 실록이 기록한 동네들을 구 별로 찾아보세요</p>
        <p class="subtitle en">Browse the Seoul Sillok neighborhood archive by district</p>

    <div class="districts">
        {orderedDistricts.map(district => (
            <section class="district" key={district.name}>
                <h2>{district.name}</h2>
                <div class="dongs">
                    {district.dongs.map((dong) => (
                        <a class="dong-card" href={`/dong/${dong.slug}`} key={dong.slug}>
                            <div class="dong-label">
                                <h3>{dong.nameKo}</h3>
                                <p>{dong.nameEn}</p>
                            </div>
                            <p class="dong-summary">{dong.summary}</p>
                            <div class="social-icons" aria-label={`${dong.nameKo} SNS`}>
                                {dong.instagramUrl ? <img src="/images/instagram.svg" alt="Instagram" /> : null}
                                {dong.youtubeId ? <img src="/images/youtube.svg" alt="YouTube" /> : null}
                                {dong.soundcloudEmbedUrl ? <img src="/images/soundcloud.svg" alt="SoundCloud" /> : null}
                            </div>
                        </a>
                    ))}
                </div>
            </section>
        ))}
    </div>
    </div>
</Layout>

<style>
    .dong-container {
        padding: 2.5rem 0 3.5rem;
        display: grid;
        gap: 2.5rem;
    }

    h1 {
        text-align: center;
        color: rgba(11, 31, 59, 0.92);
        font-size: clamp(2.3rem, 4vw, 2.8rem);
        margin-bottom: 0.5rem;
    }

    .subtitle {
        text-align: center;
        color: rgba(11, 31, 59, 0.6);
        margin-bottom: 0;
    }

    .districts {
        display: flex;
        flex-direction: column;
        gap: 2.5rem;
    }

    .district {
        background: rgba(255, 255, 255, 0.92);
        padding: 2rem;
        border-radius: 24px;
        box-shadow: 0 22px 50px rgba(11, 31, 59, 0.08);
        display: grid;
        gap: 1.75rem;
    }

    .district h2 {
        margin: 0;
        font-size: 1.4rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: rgba(11, 31, 59, 0.65);
    }

    .dongs {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        gap: 1.5rem;
    }

    .dong-card {
        display: grid;
        gap: 1rem;
        background: rgba(247, 249, 255, 0.92);
        padding: 1.6rem;
        border-radius: 20px;
        border: 1px solid rgba(11, 102, 255, 0.08);
        transition: transform 0.25s ease, border-color 0.25s ease, box-shadow 0.25s ease;
        color: inherit;
        text-decoration: none;
        min-height: 220px;
    }

    .dong-card:hover,
    .dong-card:focus-visible {
        transform: translateY(-4px);
        border-color: rgba(11, 102, 255, 0.35);
        box-shadow: 0 18px 36px rgba(11, 102, 255, 0.14);
    }

    .dong-label {
        display: flex;
        flex-direction: column;
        gap: 0.25rem;
    }

    .dong-label h3 {
        margin: 0;
        font-size: 1.35rem;
        color: rgba(11, 31, 59, 0.9);
    }

    .dong-label p {
        margin: 0;
        font-size: 0.95rem;
        color: rgba(11, 31, 59, 0.6);
    }

    .dong-summary {
        margin: 0;
        font-size: 0.95rem;
        line-height: 1.6;
        color: rgba(11, 31, 59, 0.72);
    }

    .social-icons {
        display: flex;
        gap: 0.75rem;
        margin-top: auto;
    }

    .social-icons img {
        width: 26px;
        height: 26px;
        opacity: 0.95;
    }

    @media (max-width: 720px) {
        .district {
            padding: 1.75rem 1.5rem;
        }

        .dongs {
            grid-template-columns: 1fr;
        }
    }
</style>
